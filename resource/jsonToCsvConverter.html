<!DOCTYPE html>
<html>
<head lang="en">
    <meta charset="UTF-8">
    <title></title>
    <style>
        * {
            margin: 0;
            padding: 0;
        }

        textarea {
            width: 100%;
            height: 400px;
        }

        button {
            width: 200px;
            height: 100px;
        }
    </style>
</head>
<body>

<textarea id='ta1'>
    {
	"季昌明": {
		"蔡成功": 106,
		"赵立春": 20,
		"赵瑞龙": 8,
		"沙瑞金": 140,
		"欧阳菁": 142,
		"祁同伟": 102,
		"侯亮平": 836,
		"陆亦可": 140,
		"丁义珍": 72,
		"赵德汉": 4,
		"钟小艾": 8,
		"高育良": 228,
		"陈岩石": 14,
		"李达康": 184,
		"陈海": 102,
		"高小琴": 90,
		"赵东来": 68
	},
	"沙瑞金": {
		"季昌明": 140,
		"祁同伟": 124,
		"赵立春": 106,
		"赵瑞龙": 54,
		"蔡成功": 18,
		"欧阳菁": 98,
		"陈海": 14,
		"侯亮平": 342,
		"高育良": 478,
		"丁义珍": 48,
		"钟小艾": 6,
		"陆亦可": 18,
		"陈岩石": 118,
		"李达康": 764,
		"郑西坡": 8,
		"高小琴": 22,
		"赵东来": 8
	},
	"祁同伟": {
		"季昌明": 102,
		"沙瑞金": 124,
		"赵立春": 90,
		"赵瑞龙": 240,
		"蔡成功": 136,
		"欧阳菁": 10,
		"陈海": 278,
		"侯亮平": 1162,
		"陆亦可": 28,
		"丁义珍": 230,
		"梁璐": 94,
		"钟小艾": 36,
		"高育良": 806,
		"陈岩石": 46,
		"李达康": 348,
		"高小琴": 514,
		"赵东来": 60
	},
	"赵东来": {
		"季昌明": 68,
		"蔡成功": 308,
		"陈海": 92,
		"郑西坡": 8,
		"沙瑞金": 8,
		"欧阳菁": 66,
		"祁同伟": 60,
		"侯亮平": 330,
		"陆亦可": 86,
		"丁义珍": 46,
		"赵立春": 6,
		"高育良": 10,
		"陈岩石": 56,
		"李达康": 186,
		"赵瑞龙": 8,
		"程度": 4,
		"高小琴": 32
	},
	"侯亮平": {
		"季昌明": 836,
		"蔡成功": 1346,
		"赵立春": 108,
		"郑西坡": 12,
		"沙瑞金": 342,
		"欧阳菁": 424,
		"祁同伟": 1162,
		"程度": 2,
		"陆亦可": 678,
		"丁义珍": 390,
		"周正": 24,
		"梁璐": 4,
		"赵德汉": 86,
		"钟小艾": 286,
		"高育良": 1304,
		"陈岩石": 194,
		"李达康": 618,
		"赵瑞龙": 256,
		"陈海": 834,
		"高小琴": 694,
		"赵东来": 330
	},
	"周正": {
		"蔡成功": 48,
		"李达康": 2,
		"欧阳菁": 4,
		"陈海": 2,
		"侯亮平": 24,
		"陆亦可": 16,
		"丁义珍": 10
	},
	"梁璐": {
		"赵瑞龙": 2,
		"祁同伟": 94,
		"高小琴": 4,
		"侯亮平": 4,
		"高育良": 36
	},
	"赵德汉": {
		"季昌明": 4,
		"陈海": 22,
		"侯亮平": 86,
		"高育良": 4,
		"丁义珍": 18
	},
	"钟小艾": {
		"季昌明": 8,
		"蔡成功": 10,
		"祁同伟": 36,
		"赵瑞龙": 6,
		"沙瑞金": 6,
		"陈海": 2,
		"侯亮平": 286,
		"高育良": 106,
		"赵立春": 4,
		"陈岩石": 2,
		"李达康": 4,
		"高小琴": 26
	},
	"高育良": {
		"季昌明": 228,
		"沙瑞金": 478,
		"赵立春": 124,
		"赵瑞龙": 158,
		"蔡成功": 110,
		"欧阳菁": 58,
		"祁同伟": 806,
		"侯亮平": 1304,
		"陆亦可": 20,
		"丁义珍": 234,
		"梁璐": 36,
		"赵德汉": 4,
		"钟小艾": 106,
		"陈岩石": 138,
		"李达康": 750,
		"郑西坡": 8,
		"陈海": 244,
		"高小琴": 224,
		"赵东来": 10
	},
	"赵瑞龙": {
		"季昌明": 8,
		"沙瑞金": 54,
		"赵立春": 118,
		"蔡成功": 10,
		"欧阳菁": 14,
		"祁同伟": 240,
		"侯亮平": 256,
		"陆亦可": 18,
		"丁义珍": 16,
		"梁璐": 2,
		"钟小艾": 6,
		"高育良": 158,
		"陈海": 6,
		"李达康": 76,
		"高小琴": 128,
		"赵东来": 8
	},
	"蔡成功": {
		"季昌明": 106,
		"沙瑞金": 18,
		"祁同伟": 136,
		"郑西坡": 82,
		"欧阳菁": 350,
		"陈海": 310,
		"侯亮平": 1346,
		"陆亦可": 378,
		"丁义珍": 294,
		"周正": 48,
		"钟小艾": 10,
		"高育良": 110,
		"陈岩石": 84,
		"李达康": 306,
		"赵瑞龙": 10,
		"程度": 2,
		"高小琴": 274,
		"赵东来": 308
	},
	"赵立春": {
		"季昌明": 20,
		"沙瑞金": 106,
		"陈海": 68,
		"赵瑞龙": 118,
		"祁同伟": 90,
		"侯亮平": 108,
		"高育良": 124,
		"丁义珍": 14,
		"钟小艾": 4,
		"陈岩石": 92,
		"李达康": 136,
		"郑西坡": 8,
		"高小琴": 12,
		"赵东来": 6
	},
	"郑西坡": {
		"蔡成功": 82,
		"赵立春": 8,
		"陈岩石": 144,
		"沙瑞金": 8,
		"李达康": 18,
		"赵东来": 8,
		"高小琴": 2,
		"侯亮平": 12,
		"高育良": 8
	},
	"欧阳菁": {
		"季昌明": 142,
		"蔡成功": 350,
		"祁同伟": 10,
		"赵瑞龙": 14,
		"陈岩石": 2,
		"沙瑞金": 98,
		"赵东来": 66,
		"侯亮平": 424,
		"陆亦可": 218,
		"丁义珍": 96,
		"周正": 4,
		"高育良": 58,
		"陈海": 38,
		"李达康": 850,
		"高小琴": 64
	},
	"陈海": {
		"季昌明": 102,
		"沙瑞金": 14,
		"赵立春": 68,
		"赵瑞龙": 6,
		"蔡成功": 310,
		"欧阳菁": 38,
		"祁同伟": 278,
		"侯亮平": 834,
		"陆亦可": 90,
		"丁义珍": 302,
		"周正": 2,
		"赵德汉": 22,
		"钟小艾": 2,
		"高育良": 244,
		"陈岩石": 78,
		"李达康": 146,
		"高小琴": 34,
		"赵东来": 92
	},
	"程度": {
		"蔡成功": 2,
		"赵东来": 4,
		"侯亮平": 2,
		"陆亦可": 2
	},
	"陆亦可": {
		"季昌明": 140,
		"蔡成功": 378,
		"赵东来": 86,
		"赵瑞龙": 18,
		"沙瑞金": 18,
		"欧阳菁": 218,
		"祁同伟": 28,
		"侯亮平": 678,
		"高育良": 20,
		"丁义珍": 134,
		"周正": 16,
		"陈岩石": 12,
		"李达康": 206,
		"程度": 2,
		"陈海": 90,
		"高小琴": 264
	},
	"丁义珍": {
		"季昌明": 72,
		"沙瑞金": 48,
		"陈海": 302,
		"赵瑞龙": 16,
		"蔡成功": 294,
		"欧阳菁": 96,
		"祁同伟": 230,
		"侯亮平": 390,
		"陆亦可": 134,
		"周正": 10,
		"赵德汉": 18,
		"赵立春": 14,
		"高育良": 234,
		"陈岩石": 14,
		"李达康": 350,
		"高小琴": 218,
		"赵东来": 46
	},
	"陈岩石": {
		"季昌明": 14,
		"蔡成功": 84,
		"赵立春": 92,
		"郑西坡": 144,
		"沙瑞金": 118,
		"祁同伟": 46,
		"欧阳菁": 2,
		"陈海": 78,
		"侯亮平": 194,
		"陆亦可": 12,
		"丁义珍": 14,
		"钟小艾": 2,
		"高育良": 138,
		"李达康": 168,
		"高小琴": 24,
		"赵东来": 56
	},
	"李达康": {
		"季昌明": 184,
		"沙瑞金": 764,
		"祁同伟": 348,
		"郑西坡": 18,
		"蔡成功": 306,
		"欧阳菁": 850,
		"陈海": 146,
		"侯亮平": 618,
		"陆亦可": 206,
		"丁义珍": 350,
		"周正": 2,
		"赵立春": 136,
		"钟小艾": 4,
		"高育良": 750,
		"陈岩石": 168,
		"赵东来": 186,
		"赵瑞龙": 76,
		"高小琴": 50
	},
	"高小琴": {
		"季昌明": 90,
		"蔡成功": 274,
		"陈海": 34,
		"郑西坡": 2,
		"沙瑞金": 22,
		"欧阳菁": 64,
		"祁同伟": 514,
		"侯亮平": 694,
		"陆亦可": 264,
		"丁义珍": 218,
		"梁璐": 4,
		"赵立春": 12,
		"钟小艾": 26,
		"高育良": 224,
		"陈岩石": 24,
		"李达康": 50,
		"赵瑞龙": 128,
		"赵东来": 32
	}
}
</textarea>
<textarea id='ta2'></textarea>
<button id='btn'>转换</button>
<script src="underscore.min.js"></script>
<script>

    onload = function () {
        var btn = document.getElementById('btn');
        var ta1 = document.getElementById('ta1');
        var ta2 = document.getElementById('ta2');
        btn.onclick = function () {
//        console.log(JSON.parse(ta1.innerHTML))
            var json = JSON.parse(ta1.innerHTML);
            var nameArray = [];

            for (var k in json) {
                nameArray.push(k);
            }
            var arrayLength = nameArray.length;

            //创建arrayLength*arrayLength的二维矩阵...
            var finalArray = [];
            for (var i = 1; i <= arrayLength; i++) {
                var subArray = [];
                for (var j = 1; j <= arrayLength; j++) {
                    subArray.push(0);
                }

                finalArray.push(subArray);
            }

//            console.log(JSON.stringify(finalArray))

            //finalArray push数据
            for (var name1 in json) {
                var name1Json = json[name1];
                var name1Index = _.indexOf(nameArray, name1);

                for (var name2 in name1Json) {
                    var value = name1Json[name2]
                    var name2Index = _.indexOf(nameArray, name2);
                    finalArray[name1Index][name2Index] = value
                }
            }

            //每一行数组之前加名字...
            for (var i = 0; i < finalArray.length; i++) {
                finalArray[i].unshift(nameArray[i])
            }


            //数组之前追加名字...
            finalArray.unshift(nameArray)
            console.log(JSON.stringify(finalArray));


            //生成csv...
            var str = '';
            for (var i = 0; i < finalArray.length; i++) {
                var subArray = finalArray[i];
                for (var j = 0; j < subArray.length; j++) {
//                    console.log(finalArray[i][j]);
                    var value = (finalArray[i][j])


                    if (i > 0 && j == 0) {
                        str += value;
                    } else {
                        str += ';' + value;
                    }
                }
                str += '\r\n';
            }
            ta2.innerHTML = str;
        }
    }


</script>
</body>
</html>